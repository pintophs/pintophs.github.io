<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>1D Steady-State Thermal Simulation</title>
  <link rel="stylesheet" href="../style.css">

  <!-- MathJax setup -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <main>
    <h1>1D Poisson Solver with Variable Permitivity</h1>
    <p>The Poisson's equation with variable \( \varepsilon \) is</p>
    
    <p>
    $$ \nabla \cdot (\varepsilon \nabla \phi) = - \rho, \tag{1} $$
    </p>
    
    <p>In 1D, this reduces to:</p>
    
    <p>
    $$ \frac{d}{d x}\cdot\left(\varepsilon\frac{d\phi}{dx}\right) = - \rho, \tag{2} $$
    </p>
    
    <p>Which can be approximated by a control-volume discretization:</p>
    
    <p>
    $$
    \frac{
      \varepsilon_{i+1/2} \frac{ \phi_{i+1} - \phi_i }{ \Delta x_i }
      -
      \varepsilon_{i-1/2} \frac{ \phi_i - \phi_{i-1} }{ \Delta x_{i-1} }
    }{
      \Delta x_i^{CV}
    }
    \tag{3}
    $$
    </p>
    
    <p>Where:</p>
    <ul>
    <li>$$\Delta x_i = x_{i+1} - x_i$$</li>
    <li>$$\Delta x_{i-1} = x_i - x_{i-1}$$</li>
    <li>$$\Delta x_i^{CV} = \frac{\Delta x_{i-1} + \Delta x_i}{2}$$</li>
    <li>$$\varepsilon_{i+1/2} = \frac{\varepsilon_{i+1} + \varepsilon_i }{2}$$</li>
    <li>$$\varepsilon_{i-1/2} = \frac{\varepsilon_i + \varepsilon_{i-1} }{2}$$</li>
    </ul>
    
    <p>Thus we can rewrite Eq. 3 in tridiagonal form:</p>
    
    <p>
    $$a_i\phi_{i-1} + b_i\phi_i + c_i\phi_{i+1} = f_i$$
    </p>
    
    <p>Where:</p>
    <p>
    $$
    a_i = \frac{\varepsilon_i + \varepsilon_{i-1}}{2\Delta x_{i-1}}, \quad
    b_i = -(a_i + c_i), \quad
    c_i = \frac{\varepsilon_{i+1} + \varepsilon_i}{2\Delta x_i}, \quad
    f_i = -\rho_i.
    $$
    </p>
    
    <p>This system can be expressed in matrix form as:</p>
    
    <p>
    $$
    \underbrace{
    \begin{bmatrix}
    b_2 & c_2 & 0 & \cdots & 0 \\
    a_3 & b_3 & c_3 & \ddots & \vdots \\
    0 & a_4 & b_4 & \ddots & 0 \\
    \vdots & \ddots & \ddots & \ddots & c_{N-2} \\
    0 & \cdots & 0 & a_{N-1} & b_{N-1}
    \end{bmatrix}}_{\mathbf{A} \; (N-2\times N-2)}
    \;
    \underbrace{
    \begin{bmatrix}
    \phi_2 \\ \phi_3 \\ \phi_4 \\ \vdots \\ \phi_{N-2} \\ \phi_{N-1}
    \end{bmatrix}}_{\text{unknowns}}
    =
    \underbrace{
    \begin{bmatrix}
    f_2 - a_2 \phi_1 \\
    f_3 \\
    f_4 \\
    \vdots \\
    f_{N-2} \\
    f_{N-1} - c_{N-1} \phi_N
    \end{bmatrix}}_{\text{RHS with BCs}}
    $$
    </p>
    
    <p>
    $$\mathbf{A}\boldsymbol{\phi} = \mathbf{F}$$
    </p>
    
    <p>Where:</p>
    <ul>
    <li>\(\mathbf A = (n-2)\times (n-2)\) is the tridiagonal coefficient matrix (only internal nodes)
      <ul>
        <li>\(a_i\) is the lower diagonal</li>
        <li>\(b_i\) is the main diagonal</li>
        <li>\(c_i\) is the upper diagonal</li>
      </ul>
    </li>
    <li>\(\mathbf \phi = (n-2) \times 1\) is the column vector of unknown potentials at internal nodes</li>
    <li>\(\mathbf F = (n-2) \times 1\) is the RHS column vector, including the charge density and contributions from boundary conditions, \(F_i = -\rho_i - \text{BC contribution}\).</li>
    </ul>

  </main>

  <footer>
    <small><a href="../index.html">‚Üê Back to main page</a></small>
  </footer>
</body>
</html>

