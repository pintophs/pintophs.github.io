<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>1D Steady-State Thermal Simulation</title>
  <link rel="stylesheet" href="../style.css">

  <!-- MathJax setup -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
</head>
<body>
  <main>
    <h1>1D Steady-State Thermal Simulation</h1>

    <h2>Grid Setup</h2>
    <p>
      Let a 1D rod of length <em>L</em> be discretized into <em>N</em> segments of varying lengths:
    </p>

    <figure>
      <img src="../assets/images/plot1.png" alt="Non-uniform grid" style="width:100%;">
      <figcaption>Non-uniform grid</figcaption>
    </figure>

    <p>(it is actually \(i_N\) at the last point)</p>

    <p>Define \(N+1\) nodes (indexed \(i = 0, 1, \ldots, N\)) with non-uniform spacing:</p>

    <ul>
      <li>Node positions: \(x_0, x_1, \ldots, x_N\).</li>
      <li>Node material properties: \(\kappa_0, \kappa_1, \ldots, \kappa_N\).</li>
      <li>Node temperature: \(T_0, T_1, \ldots, T_N\).</li>
      <li>Segment widths: \(\Delta x_i = x_{i+1} - x_i\).</li>
    </ul>

    <p>
      Conductivity between nodes (e.g., at \(x_{i+\frac{1}{2}}\)) is approximated by averaging adjacent nodal values. 
      For smooth materials:
    </p>

    <p>$$
      \kappa_{i+\frac{1}{2}} = \frac{\kappa_{i+1} + \kappa_i}{2}, \quad
      \kappa_{i-\frac{1}{2}} = \frac{\kappa_i + \kappa_{i-1}}{2}.
    $$</p>

    <p>
      This ensures that fluxes (e.g., \(\kappa \frac{\partial T}{\partial x}\)) are computed at midpoints \(i \pm \frac{1}{2}\),
      while their divergence \(\nabla \cdot (\kappa \nabla T)\) aligns with node \(i\) after discretization,
      preserving grid consistency.
    </p>

    <h3>Control Volume</h3>
    <p>
      To enforce energy conservation on a non-uniform grid, each node \(i\) is associated with a control volume:
    </p>

    <p>$$
      \Delta x_i^{CV} = x_{i + \frac{1}{2}} - x_{i - \frac{1}{2}} = \frac{\Delta x_{i-1} + \Delta x_i}{2}.
    $$</p>

    <figure>
      <img src="../assets/images/tikz.png" alt="Δx on non-uniform grid" style="width:80%;">
      <figcaption>Δx on non-uniform grid</figcaption>
    </figure>

    <p>
      This will be used to approximate the divergence of the heat flux at each node, which in 1D corresponds
      to how much the heat flow is increasing or decreasing per unit length.
    </p>

    <h2>Governing Equations</h2>
    <p>
      The steady-state heat equation is derived from conservation of energy and Fourier's law.
      For a spatially varying thermal conductivity \(\kappa\), it takes the divergence form:
    </p>

    <p>$$
      \nabla \cdot (\kappa \nabla T) = 0.
    $$</p>

    <p>
        This equation ensures that the net heat flux out of any infinitesimal volume is zero in steady state.
    </p>
    <p>
      Expressing the LHS of Eq. 3 in the form of partial derivatives, we have
    </p>

    <p>$$
      \nabla \cdot (\kappa \nabla T) =
      \frac{\partial}{\partial x} \left(\kappa\frac{\partial T}{\partial x}\right).
    $$</p>

    <p>Now we can approximate the first-order partial derivatives by first-order finite difference approximations. Applying the finite difference method to the RHS of Eq. (4), we have</p>

    $$
    \nabla \cdot (\kappa \nabla T) \approx
    \frac{
      \kappa_{i+\frac{1}{2}}
      \overbrace{\dfrac{\partial T}{\partial x} \Big|_{i+\frac{1}{2}}}^{I}
      -
      \kappa_{i-\frac{1}{2}}
      \overbrace{\dfrac{\partial T}{\partial x} \Big|_{i-\frac{1}{2}}}^{II}
    }{
      x_{i+\frac{1}{2}} - x_{i-\frac{1}{2}}
    }.
    $$
    
    <p style="text-align: right;">
    Note that \(x_{i+\frac{1}{2}} - x_{i-\frac{1}{2}} = \Delta x_i^{CV}\).
    </p>
    
    <p>We can use the same technique to obtain an approximation for the terms \(I\) and \(II\):</p>
    
    $$
    \frac{\partial T}{\partial x} \Big|_{i+\frac{1}{2}} \approx
    \frac{T_{i+1/2} - T_{i-1/2}}{x_{i+1/2} - x_{i-1/2}} \Big|_{i+\frac{1}{2}}
    =
    \frac{T_{(i+1/2)+1/2} - T_{(i+1/2)-1/2}}{x_{(i+1/2)+1/2} - x_{(i+1/2)-1/2}}
    =
    \frac{T_{i+1} - T_i}{x_{i+1} - x_i}
    =
    \frac{T_{i+1} - T_i}{\Delta x_i}.
    $$
    
    <p>Note that \(\partial T / \partial x\) was evaluated twice above because \(T\) is derived two times in the full equation.</p>
    
    $$
    \frac{\partial T}{\partial x} \Big|_{i-\frac{1}{2}} \approx
    \frac{T_i - T_{i-1}}{\Delta x_{i-1}}.
    $$
    
    <p>Substituting the final form of Eqs. (6) and (7) into Eq. (5), we have</p>
    
    $$
    \nabla \cdot (\kappa \nabla T) \approx
    \dfrac{
      \kappa_{i+\frac{1}{2}} \dfrac{T_{i+1} - T_i}{\Delta x_i}
      -
      \kappa_{i-\frac{1}{2}} \dfrac{T_i - T_{i-1}}{\Delta x_{i-1}}
    }{
      \Delta x_i^{CV}
    }.
    $$
    
    <p>Expanding \(\kappa\) of Eq. (8) brings us to the standard finite-volume discretization for non-uniform grids:</p>
    
    $$
    \nabla \cdot (\kappa \nabla T) \approx
    \dfrac{
      \dfrac{\kappa_{i+1} + \kappa_i}{2}
      \cdot
      \dfrac{T_{i+1} - T_i}{\Delta x_i}
      -
      \dfrac{\kappa_i + \kappa_{i-1}}{2}
      \cdot
      \dfrac{T_i - T_{i-1}}{\Delta x_{i-1}}
    }{
      \Delta x_i^{CV}
    }.
    $$
    
    <p>To rewrite the equation above as a matrix-ready expression, let us call:</p>
    
    $$
    A = \frac{\kappa_{i+1} + \kappa_i}{2\Delta x_i}
    $$
    
    $$
    B = \frac{\kappa_i + \kappa_{i-1}}{2\Delta x_{i-1}}
    $$
    
    <p>Then substituting Eqs. (10) and (11) into Eq. (9), we get</p>
    
    $$
    \frac{A(T_{i+1} - T_i) - B(T_i - T_{i-1})}{\Delta x_i^{CV}} = 0.
    $$
    
    <p>Multiply both sides by \(\Delta x_i^{CV}\):</p>
    
    $$
    A(T_{i+1} - T_i) - B(T_i - T_{i-1}) = 0.
    $$
    
    <p>Distributing the terms:</p>
    
    $$
    A T_{i+1} + (-A - B) T_i + B T_{i-1} = 0.
    $$
    
    <p>Now we can create the final coefficients as</p>
    
    $$
    a_i = B, \quad b_i = -A - B, \quad c_i = A.
    $$
    
    $$
    a_i = \frac{\kappa_i + \kappa_{i-1}}{2\Delta x_{i-1}}, \quad
    b_i = -(a_i + c_i), \quad
    c_i = \frac{\kappa_{i+1} + \kappa_i}{2\Delta x_i}.
    $$
    
    <p>And at last, arrive at the general form</p>
    
    $$
    a_i T_{i-1} + b_i T_i + c_i T_{i+1} = 0.
    $$
    
    <p>This gives a tridiagonal linear system of the form \(A \vec{T} = \vec{b}\), where \(A\) is a tridiagonal matrix with entries \(a_i, b_i, c_i\) and \(\vec{b}\) is the boundary condition vector.</p>


  </main>

  <footer>
    <small><a href="../index.html">← Back to main page</a></small>
  </footer>
</body>
</html>

